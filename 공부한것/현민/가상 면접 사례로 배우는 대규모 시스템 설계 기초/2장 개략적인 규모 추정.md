# 개략적인 규모 추정

때로는 시스템 용량이나 성능 요구사항을 개략적으로 추정해보라는 요구를 받게 된다.

개략적 규모 추정을 효과적으로 해 내려면 규모 확장성을 표현하는 데 필요한 기본기에 능숙해야 한다.

## 2의 제곱수

분산 시스템에서 다루는 데이터 양은 엄청나게 커질 수 있지만 계산법은 기본을 크게 벗어나지 않는다.

데이터 볼륨의 단위를 2의 제곱수로 표현하면 어떻게 되는지를 우선 알아야 한다. 최소 단위는 1바이트이고, 8비트로 구성된다.

<br>

흔히 쓰이는 데이터 볼륨 단위는 아래와 같다.

2의 10제곱 → 근사치 1천 → 1킬로바이트(1KB)

2의 20제곱 → 근사치 1백만 → 1메가바이트(1MB)

2의 30제곱 → 근사치 10억 → 1기가바이트(1GB)

2의 40제곱 → 근사치 1조 → 1테라바이트(1TB)

## 모든 프로그래머가 알아야 하는 응답지연 값

2020년 기준의 통상적인 컴퓨터에서 구현된 연산들의 응답지연 값은 아래와 같다.

`ns = 나노초, us = 마이크로초, ms = 밀리초`

![image](https://github.com/gusals00/mentoring/assets/87007552/68972e2c-1a86-45fe-8d97-48c03d3f394d)

위의 수치를 보면 다음과 같은 결론이 나온다.

- 메모리는 빠르지만 디스크는 아직도 느리다.
- 디스크 탐색은 가능한 피하라
- 단순한 압축 알고리즘은 빠르다
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
- 데이터 센터는 보통 여러 지역에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.

## 가용성에 관계된 수치들

고가용성은 시스템이 오랜 시간 동안 지속적으로 중단 없이 운영될 수 있는 능력을 말하는 용어이다.

고가용성은 퍼센트로 표현하는데, 100%는 단 한 번도 시스템이 중단된 적이 없었음을 의미한다.

대부분의 서비스는 99%~100% 사이의 값을 갖는다.

## 예제 : 트위터 QPS와 저장소 요구량 추정

**가정**

- MAU → 3억명
- 50%의 사용자가 매일 사용함.
- 평균적으로 각 사용자는 매일 2건의 트윗을 올림.
- 미디어를 포함하는 트윗은 10%정도.
- 데이터는 5년간 보관됨.

**추정**

QPS(Query Per Second) 추정치

- DAU → 3억 * 50% = 1.5억
- QPS → 1.5억 * 2트윗 / 24시간 / 3600초 = 약 3500
- 최대 QPS(Peek QPS) = 2 * QPS = 약 7000

<br>

미디어 저장을 위한 저장소 요구량

- 평균 트윗 크기
  - tweet_id → 64바이트
  - 텍스트 → 140바이트
  - 미디어 → 1MB
- 미디어 저장소 요구량 → 1.5억 * 2 * 10% * 1 MB = 30TB / 일
- 5년간 미디어를 보관하기 위한 저장소 요구량 → 30TB * 365 * 5 = 약 55PB
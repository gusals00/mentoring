**URL의 주요 구성 요소**

![image](https://github.com/gusals00/mentoring/assets/87007552/107f719e-f643-40fb-b279-39508bddef09)


- 프로토콜 : 웹 브라우저가 서버와 내용을 주고받을 때 사용할 규칙 이름. 웹 페이지의 주소를 표현할 때는 http를 사용한다.
- 서버 이름 : 웹 페이지를 요청할 서버의 이름을 지정한다. 도메인 이름이나 IP 주소를 입력할 수 있다.
- 경로 : 웹 페이지의 상세 주소에 해당한다.
- 쿼리 문자열 : 추가로 서버에 보내는 데이터에 해당한다. 같은 경로라 하더라도 입력한 값에 따라 다른 결과를 보여줘야 할 때 사용한다.

**웹 브라우저와 웹 서버**

![image](https://github.com/gusals00/mentoring/assets/87007552/470be87d-5dfd-4bf7-b789-8cb0daa94ca8)


- 웹 브라우저에서 URL을 입력하면 웹 브라우저는 도메인 이름에 해당하는 IP 주소를 DNS에 요청하고 DNS는 IP 주소를 응답으로 제공한다.
- DNS로부터 IP주소를 받으면, 웹 브라우저는 3번 과정처럼 IP주소를 이용해서 웹 서버에 연결한 뒤 URL에 해당하는 웹 페이지를 요청하고 웹 페이지를 응답으로 받게 된다.

IP주소 만으로는 컴퓨터의 어떤 서버 프로그램을 실행할지 알 수 없기 때문에 **포트**를 사용한다. 서버 프로그램마다 구분되는 포트 번호를 사용하여 IP 주소와 함께 포트 번호를 사용해서 원하는 서버 프로그램에 연결하게 된다.

**HTML과 HTTP**

웹 서버는 URL에 해당하는 HTML 문서를 전송하는데, HTML 문서를 받은 웹 브라우저는 정해진 규칙에 따라 HTML 문서를 분석해서 알맞은 화면을 생성한다.

HTML 표준에 따라 HTML 문서로부터 알맞은 화면을 생성하는 과정을 **렌더링** 이라고도 표현한다.

HTTP는 웹 브라우저와 웹 서버가 HTML을 비롯해 이미지, 동영상, XML 문서 등 다양한 데이터를 주고받을 때 사용하는 일종의 규칙이다.

HTTP는 크게 두 가지 관점에서 규칙을 정의하고 있다.

- 요청 규칙 : 웹 브라우저가 웹 서버에 HTML과 같은 것을 요청할 때 사용할 데이터 구성 규칙
- 응답 규칙 : 웹 서버가 웹 브라우저에 HTML과 같은 것을 전송할 때 사용할 데이터 구성 규칙

![image](https://github.com/gusals00/mentoring/assets/87007552/ce9275d6-252c-460f-98dd-3cae34d92ad0)


요청 데이터는 웹 브라우저가 웹 서버로부터 무엇을 받고 싶은지 기술한다. 이 요청 데이터를 받은 웹 서버는 요청 데이터에 기술한 정보를 이용해서 웹 브라우저가 요청한 것을 응답 데이터에 담아 보낸다.

HTTP에서 요청 데이터와 응답 데이터는 크게 **요청/응답 줄, 헤더, 몸체** 세 개의 영역으로 구성된다.

요청/응답 줄은 GET / HTTP/1.1 이 요청 줄이고, HTTP/1.1 200 OK 가 응답 줄에 해당한다.

헤더 영역은 요청/응답 줄 다음에 위치하며 “헤더이름: 헤더 값”으로 구성된 헤더 목록으로 구성된다.

헤더가 끝난 다음 빈 줄이 오고 그 다음에 몸체 내용이 온다.

| 구성 요소 | 요청 데이터 | 응답 데이터 |
| --- | --- | --- |
| 요청/응답 줄 | GET이나 POST같은 HTTP 요청 방식과 요청하는 자원의 경로를 지정한다. | 요청에 대해 200이나 404같은 응답 코드를 전송한다. |
| 헤더 | 서버가 응답을 생성하는데 참조할 수 있는 정보를 전송한다. 브라우저의 종류나 언어 등의 정보를 보낸다. | 응답에 대한 정보를 전송한다. 응답의 몸체가 어떤 데이터인지, 길이는 어떻게 되는지 등에 대한 정보를 담는다.  |
| 몸체 | 정보를 전송해야 할 때 사용한다. | 웹 브라우저가 요청한 자원의 내용을 담는다. |

**정적 자원과 동적 자원**

웹 브라우저가 항상 같은 응답 데이터를 받아서 화면에 출력하는 URL에 해당하는 자원을 **정적 자원**이라고 한다.

정적 자원과 달리 파일을 바꾸지 않아도 조건에 따라 다른 응답 데이터를 전송하는 URL에 해당하는 자원을 **동적 자원** 이라고 한다.

**웹 프로그래밍과 JSP**

웹 프로그래밍이란 웹 서버가 웹 브라우저에 응답으로 전송할 데이터를 생성해주는 프로그램을 작성하는 것이다.

JSP는 동적 페이지를 작성하는데 사용되는 자바의 표준 기술로서 HTML 응답을 생성하는데 필요한 기능을 제공하고 있다.

JSP를 이용해서 만든 프로그램을 실행하려면 톰캣이나 제티같은 서버 프로그램이 필요하다. 단순 웹 서버가 정적인 HTML 파일이나 이미지를 제공하는 것과 달리 이들 서버는 웹을 위한 연결, 프로그래밍 언어, 데이터베이스 연동과 같이 애플리케이션을 구현하는데 필요한 기능을 제공한다. 이 서버 프로그램을 웹 애플리케이션 서버(WAS) 라고 부른다.

WAS는 웹 브라우저로부터 요청이 오면 알맞은 프로그램을 찾아 실행하고, 실행 결과를 응답으로 전송한다.

**JSP**

- 디렉티브
    - JSP 페이지에 대한 설정 정보를 지정할 때 사용
    - <%@ 디렉티브이름 속성1=”값1” 속성2=”값2” … %>
    - JSP가 제공하고 있는 디렉티브
        - page : JSP 페이지에 대한 정보를 지정한다. JSP가 생성하는 문서의 타입, 출력 버퍼의 크기, 에러 페이지 등 JSP 페이지에서 필요로 하는 정보 설정
        - taglib : JSP 페이지에서 사용할 태그 라이브러리를 지정한다.
        - include : JSP 페이지의 특정 영역에 다른 문서를 포함시킨다.

- 스크립트 요소
    - JSP에서 문서의 내용을 동적으로 생성하기 위해 사용되는 것
    - JSP의 스크립트 요소
        - 표현식 : 값을 출력한다.
        - 스크립트릿 : 자바 코드를 실행한다.
        - 선언부 : 자바 함수를 만든다.
        
- 기본 객체
    - request 기본 객체
        - 제공하는 기능
            - 클라이언트, 서버와 관련된 정보 읽기 기능
            - 클라이언트가 전송한 요청 파라미터, 요청 헤더, 쿠키 읽기 기능
            - 속성 처리 기능
    - response 기본 객체
        - 제공하는 기능
            - 헤더 정보 입력
            - 리다이렉트
    - out 기본 객체
        - JSP 페이지가 생성하는 모든 내용은 out 기본 객체를 통해 전송된다.
    - pageContext 기본 객체
        - 제공하는 기능
            - 기본 객체 구하기(다른 기본 객체에 접근할 수 있다.)
            - 속성 처리하기
            - 페이지의 흐름 제어하기
            - 에러 데이터 구하기
    - application 기본 객체
        - 특정 웹 애플리케이션에 포함된 모든 JSP 페이지는 하나의 application 기본 객체를 공유한다.
        - 웹 애플리케이션 전반에 걸쳐서 사용되는 정보를 담고 있다. 초기 설정 정보나 서버 정보를 읽거나, 웹 애플리케이션이 제공하는 자원을 읽어올 수도 있다.

**JSP 처리 과정**

![image](https://github.com/gusals00/mentoring/assets/87007552/e2936a4f-e498-4436-b44b-bc6ec0660538)


WAS는 JSP 페이지에 대한 요청이 들어오면 다음과 같은 처리를 한다.

- JSP에 해당하는 서블릿이 존재하지 않을 경우
    - JSP 페이지로부터 자바 코드를 생성한다.
    - 자바 코드를 컴파일해서 서블릿 클래스를 생성한다.
    - 서블릿에 클라이언트 요청을 전달한다.
    - 서블릿이 요청을 처리한 결과를 응답으로 생성한다.
    - 응답을 웹 브라우저에 전송한다.
- JSP에 해당하는 서블릿이 존재하는 경우
    - 서블릿에 클라이언트 요청을 전달한다.
    - 서블릿이 요청을 처리한 결과를 응답으로 생성한다.
    - 응답을 웹 브라우저에 전송한다.

즉 JSP 페이지를 요청할 때는 JSP를 직접 실행하는 것이 아니라 JSP를 자바 소스 코드로 변환한 뒤 컴파일해서 생성한 서블릿을 실행하는 것이다.

**출력 버퍼와 응답**

JSP 페이지는 응답 결과를 바로 웹 브라우저에 전송하지 않고 출력 버퍼라고 불리는 곳에 임시로 응답 결과를 저장했다가 한 번에 웹 브라우저에 전송한다.

출력 버퍼를 사용하면서 생기는 장점은 다음과 같다.

- 데이터 전송 성능 향상
- JSP 실행 도중에 버퍼를 비우고 새로운 내용 전송 가능
- 버퍼가 다 차기 전까지 헤더 변경 가능

**웹 애플리케이션 폴더 구성**

서블릿/JSP로 구성된 웹 애플리케이션의 기본 폴더 구조는 다음과 같다

![image](https://github.com/gusals00/mentoring/assets/87007552/63b160e7-91d3-4352-8b15-f4d8c68bad75)


WEB-INF : 웹 애플리케이션 설정 정보를 담고 있는 web.xml 파일이 위치한다.

WEB-INF/classes : 웹 애플리케이션에서 사용하는 클래스 파일이 위치한다.

WEB-INF/lib : 웹 애플리케이션에서 사용하는 jar 파일이 위치한다.

**JSP 기본 객체와 영역**

웹 애플리케이션은 다음의 네 가지 영역으로 구성되고 관련된 기본 객체를 갖는다.

- PAGE 영역 : 하나의 JSP를 처리할 때 사용되는 영역, pageContext 기본 객체
- REQUEST 영역 : 하나의 HTTP 요청을 처리할 때 사용되는 영역, request 기본 객체
- SESSION 영역 : 하나의 웹 브라우저와 관련된 영역, session 기본 객체
- APPLICATION 영역 : 하나의 웹 애플리케이션과 관련된 영역, application 기본 객체

위 네 개의 기본 객체들은 속성을 갖는다. 각 기본 객체가 존재하는 동안 기본 객체의 속성을 사용할 수 있다. 속성은 JSP 페이지 사이에서 정보를 주고받거나 공유하기 위한 목적으로 사용된다.

**페이지 모듈화와 요청 흐름 제어**

- <jsp:include> 액션 태그를 사용하면 다른 JSP의 실행 결과나 코드를 포함할 수 있다.
    - <jsp:param> 태그를 사용해 포함할 JSP 페이지에 파라미터를 추가할 수 있다.
- include 디렉티브를 사용해도 다른 페이지를 현재 위치에 포함 시킬 수 있지만 <jsp:include> 태그와 include 디렉티브는 포함하는 방식에 차이가 있다.
    - <jsp:include> 태그는 다른 JSP로 실행 흐름을 이동시켜 실행 결과를 현재 위치에 포함하는 방식이고, include 디렉티브는 다른 파일의 내용을 현재 위치에 삽입하는 방식이다.
- <jsp:forward> 액션 태그는 하나의 JSP 페이지에서 다른 JSP 페이지로 요청 처리를 전달할 때 사용된다.
    - 전달되기 전에 사용한 request, response 기본 객체가 그대로 전달된다.
    - 웹 컨테이너 내에서 요청 흐름을 이동시키기 때문에, 웹 브라우저는 다른 JSP가 요청을 처리했다는 사실을 알지 못한다. 따라서 웹 브라우저 주소는 바뀌지 않는다.
    - <jsp:forward>를 실행하기 전에 출력 버퍼를 비우기 때문에 실행하기 이전에 출력 버퍼에 저장했던 내용은 웹 브라우저에 전송되지 않는다.

**자바빈**

자바빈은 속성, 변경 이벤트, 객체 직렬화를 위한 표준이다. 이 중에서 JSP에서는 속성을 표현하기 위한 용도로 사용된다.

자바빈 규약을 따르는 클래스를 자바빈이라 부른다.

자바빈 규약

- default 패키지 이외의 특정 패키지에 속해 있어야 한다.
- 기본 생성자를 가지고 있어야 한다.
- 맴버변수는 private로 선언되어야 한다.
- 맴버변수에 접근 하기위한 public 접근자인 getter/setter 메소드가 존재해야 한다.

<jsp:useBean> 액션 태그는 JSP 페이지에서 사용할 자바빈 객체를 지정할 때 사용한다.

- <jsp:useBean id=”[빈이름]” class=”[자바빈클래스이름]” scope=”[범위]” />
    - id : jsp 페이지에서 자바빈 객체에 접근할 때 사용할 이름을 지정한다.
    - class : 패키지 이름을 포함한 자바빈 클래스의 완전한 이름을 입력한다.
    - scope : 자바빈 객체를 저장할 영역을 지정한다. page, request, session, application 중 하나를 값으로 갖는다.
- 객체를 생성할 뿐만 아니라 지정한 영역에 저장하고, 이미 영역에 객체가 존재하면 그 객체를 사용한다.

<jsp:setProperty> 액션 태그를 사용하면 생성한 자바빈 객체의 프로퍼티 값을 변경할 수 있다.

<jsp:getProperty> 액션 태그는 자바빈 객체의 프로퍼티 값을 출력할 때 사용된다.

**쿠키**

쿠키는 웹 브라우저가 보관하는 데이터이다. 웹 브라우저는 웹 서버에 요청을 보낼 때 쿠키를 함께 전송하며, 웹 서버는 웹 브라우저가 전송한 쿠키를 사용해서 필요한 데이터를 읽을 수 있다.

쿠키 동작 방식

- 쿠키 생성 단계 : JSP 프로그래밍에서 쿠키는 웹 서버 측에서 생성한다. 생성한 쿠키를 응답 데이터의 헤더에 저장해서 웹 브라우저에 전송한다.
- 쿠키 저장 단계 : 웹 브라우저는 응답 데이터에 포함된 쿠키를 쿠키 저장소에 보관한다. 쿠키의 종류에 따라 메모리나 파일에 저장한다.
- 쿠키 전송 단계 : 웹 브라우저는 저장한 쿠키를 요청이 있을 때마다 웹 서버에 전송한다. 웹 서버는 웹 브라우저가 전송한 쿠키를 사용해서 필요한 작업을 수행한다.

쿠키의 구성

- 이름 : 각각의 쿠키를 구별하는데 사용되는 이름
- 값 : 쿠키의 이름과 관련된 값
- 유효시간 : 쿠키의 유지 시간
- 도메인 : 쿠키를 전송할 도메인
- 경로 : 쿠키를 전송할 요청 경로

쿠키의 핵심 요소는 이름과 값이다. 하나의 웹 브라우저는 여러개의 쿠키를 가질 수 있는데 각 쿠키를 구분할 때 이름을 사용한다.

**세션**

웹 브라우저에 정보를 보관할 때 쿠키를 사용한다면, 세션은 웹 컨테이너에 정보를 보관할 때 사용한다. 세션은 오직 서버에만 생성된다. 

웹 브라우저마다 별도의 세션을 갖는다. 이때 각 세션을 구분하기 위해 세션마다 고유 ID를 할당하는데 그 아이디를 세션 ID라고 한다. 웹 서버는 웹 브라우저에게 세션 ID를 전송한다. 웹 브라우저는 웹 서버에 연결할 때마다 매번 세션 ID를 보내서 웹 서버가 어떤 세션을 사용할지 판단할 수 있게 한다.

웹 서버는 세션 ID를 이용해서 웹 브라우저를 위한 세션을 찾기 때문에, 웹 서버와 웹 브라우저는 세션 ID를 공유할 수 있는 방법이 필요하다. 세션 ID를 공유하기 위해 사용하는 것이 쿠키이다.

**표현 언어(EL)**

표현 언어는 값을 표현하는 데 사용하는 스크립트 언어로 JSP의 스크립트 요소를 보완하는 역할을 한다. 다음과 같은 기능을 제공한다.

- JSP의 네 가지 기본 객체가 제공하는 영역의 속성 사용
- 수치 연산, 관계 연산, 논리 연산자 제공
- 자바 클래스 메소드 호출 기능 제공
- 쿠키, 기본 객체의 속성 등 JSP를 위한 표현 언어의 기본 객체 제공
- 람다식을 이용한 함수 정의와 실행
- 스트림 API를 통한 컬렉션 처리
- 정적 메소드 실행

다음과 같이 $와 { } 그리고 표현식을 사용해 값을 표현한다.

```java
<% -- 표현식 --%>
<%= member.getAddress().getZipcode() %>

<% -- 표현 언어 --%>
${member.address.zipcode}
```

${expr} 형식 뿐만 아니라 #{expr} 구문도 지원하는데 둘의 차이점은 실제로 EL의 값을 언제 생성하느냐에 있다.

- ${expr} 형식은 ${expr} 구문을 분석할 때 바로 값을 계산한다
- #{expr} 형식은 실제로 값이 사용될 때 값을 계산한다.

**JSTL**

JSP는 <jsp:include>와 같은 태그를 개발자가 추가할 수 있는 기능을 제공하는데, 이를 커스텀 태그라고 한다. 커스텀 태그 중에서 많이 사용되는 것을 모아서 JSTL이라는 표준을 만들었다.
